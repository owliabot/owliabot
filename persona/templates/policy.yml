# OwliaBot Tool Security Policy
# @see docs/design/tier-policy.md

version: "1"

# Global defaults
defaults:
  tier: none
  requireConfirmation: false
  allowedUsers: assignee-only
  timeout: 120 # seconds

# Emergency stop
emergencyStop:
  enabled: true
  commands:
    - "/stop"
    - "/emergency"
    - "/halt"
  channels:
    - telegram
    - discord

# Tool-specific policies
tools:
  # ── Read-only tools (no confirmation) ──
  "echo":
    tier: none

  "help":
    tier: none

  "list_files":
    tier: none

  "memory_get":
    tier: none

  "memory_search":
    tier: none

  "read_text_file":
    tier: none

  "web_fetch":
    tier: none

  "web_search":
    tier: none

  "wallet_balance":
    tier: none

  # ── Write tools (workspace changes) ──
  "edit_file":
    tier: none
    requireConfirmation: false

  "write_file":
    tier: none
    requireConfirmation: false

  "delete_file":
    tier: none
    requireConfirmation: false

  "apply_patch":
    tier: none
    requireConfirmation: false

  "clear_session":
    tier: none
    requireConfirmation: false

  "cron":
    tier: none

  "exec":
    tier: none
    requireConfirmation: false
    cooldown:
      maxPerHour: 60

  # ── Wallet tools (require confirmation when implemented) ──
  "wallet_transfer":
    tier: none
    requireConfirmation: false  # TODO: enable when confirmation implemented
    cooldown:
      maxPerHour: 10

  "wallet_send_tx":
    tier: none
    requireConfirmation: false  # TODO: enable when confirmation implemented
    cooldown:
      maxPerHour: 10

# Wildcard patterns (first match wins)
wildcards:
  - pattern: "*_get_*"
    tier: none
  - pattern: "*_list_*"
    tier: none
  - pattern: "*_search_*"
    tier: none
  - pattern: "*_read_*"
    tier: none

# Fallback for unknown tools
fallback:
  tier: none
  requireConfirmation: false
